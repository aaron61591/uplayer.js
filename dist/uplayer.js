"use strict";!function(){function a(a){for(var d in a.raw)"function"==typeof a.raw[d]?b(a,d):c(a,d)}function b(a,b){a[b]=function(){a.raw[b].apply(a.raw,arguments)}}function c(a,b){Object.defineProperties(a,{}[b]={get:function(){return a.raw[b]},set:function(c){a.raw[b]=c}})}function d(){}window.UPlayer.transit={},window.UPlayer.getContext=function(b){var c={raw:b.canvas.getContext("2d")};return a(c),d(c),c}}(),function(){function a(a,b){a.canvas=document.createElement("canvas"),a.ctx=window.UPlayer.getContext(a),a.opt=b||{},a.plugins=a.opt.debug?[window.UPlayer.debug]:[],a.pluginsIndex={},a.curFrame=0}function b(a){c(a);for(var b=0;b<a.plugins.length;)a.plugins[b]&&("function"==typeof a.plugins[b]?a.plugins[b](a.ctx,a.curFrame):"function"==typeof a.plugins[b].render&&a.plugins[b].render(a.ctx,a.curFrame)),++b}function c(a){(a.opt.refresh||void 0===a.opt.refresh)&&a.ctx.clearRect(0,0,a.canvas.width,a.canvas.height)}function d(a){a.style.position="fixed",a.style.top=0,a.style.left=0,a.style.zIndex=1e3,document.body.appendChild(a),e(a),window.onresize=function(){e(a)}}function e(a){a.width=window.innerWidth,a.height=window.innerHeight}function f(a,b){for(var c in a.pluginsIndex)a.pluginsIndex.hasOwnProperty(c)&&a.pluginsIndex[c]>=b&&++a.pluginsIndex[c]}function g(a,b){for(var c in a.pluginsIndex)a.pluginsIndex.hasOwnProperty(c)&&a.pluginsIndex[c]>=b&&++a.pluginsIndex[c]}function h(a,b,c){a.plugins.splice(c,1),a.pluginsIndex[b]=void 0,g(a,c)}function i(a,c){var d=+new Date;c||(c=d),a.playing&&(d-c>1e3/(a.opt.fps||30)&&(b(a),++a.curFrame,c=d),k.call(window,function(){i(a,c)}))}function j(b){var c=this;a(c,b),(void 0===c.opt.fullScreen||c.opt.fullScreen)&&d(c.canvas)}var k=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.setTimeout;j.prototype.plug=function(a){var b=0;if(void 0!==a.zIndex){for(;b<this.plugins.length&&!(a.zIndex<this.plugins[b].zIndex);)++b;this.plugins.splice(b,0,a)}else b=this.plugins.length,this.plugins.push(a);if(void 0!==a.hash){var c=this.pluginsIndex[a.hash];void 0!==c?"object"==typeof c?c.push(b):this.pluginsIndex[a.hash]=[c,b]:(f(this,b),this.pluginsIndex[a.hash]=b)}},j.prototype.plugnImage=function(a){var b=this;window.UPlayer.preImage(a.src,function(c){a.render=function(b,d){a.action&&a.action();var e=a.scale||1;b.drawImage(c,d%a.frame*c.width/a.frame,0,c.width/a.frame,c.height,a.x,a.y,c.width/a.frame*e,c.height*e)},b.plug(a)})},j.prototype.unplug=function(a){var b=this.pluginsIndex[a];if(void 0!==b)if("object"!=typeof b)h(this,a,b);else for(var c=b.length;c--;)h(this,a,b[c])},j.prototype.run=function(){var a=this;a.playing=!0,i(a)},j.prototype.pause=function(){this.playing=!1},j.prototype.stop=function(){this.curFrame=0,this.playing=!1},window.UPlayer=j}();